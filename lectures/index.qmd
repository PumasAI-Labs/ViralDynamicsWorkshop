---
title: "DeepPumas for Viral Dynamics Workshop"
subtitle: "Combining Mechanism and Machine Learning"
author:
  - Niklas Korsbo
  - Sreenath Krishnan
affiliation: Pumas-AI
format:
  html:
    toc: true
    toc-location: left
    code-fold: true
    code-summary: "Click to show/hide code"
    theme: 
      light: [cosmo, CSS/style-light.css]
      dark: [darkly, CSS/style-dark.css]
    number-sections: true
    css: 
      - CSS/company.scss
      - CSS/deeppumas.scss
      - CSS/deeppumas-style.css
    resources:
      - "fonts/AmplitudeBook.otf"
---


## Workshop Materials

Welcome to the DeepPumas for Viral Dynamics Workshop! This full-day workshop will teach you how to combine mechanistic modeling with machine learning using DeepPumas for viral dynamics and other pharmacometric applications.

All materials are ready and available below. Navigate to the slides and exercises using the schedule and links provided.

### Getting the code to run the hands-on exercises

- Fire up a DeepPumas app in [juliahub.com](https://juliahub.com/)
  - You should have received a coupon code in your email. This code will give you credits and access to the DeepPumas app.
  - When launching the DeepPumas app, use "launch custom instance" and select 16vCPU and a 9h time limit.
- Wait a minute for the VSCode view to pop up in your browser.
- Clone this repository either
  - In the **GUI**
    1. Bring up the command pallette (`Ctrl+shift+p`, or from the cogwheel in the bottom left corner)
    1. Search for `git clone`
    1. clone `https://github.com/PumasAI-Labs/ViralDynamicsWorkshop.git` into `/home/jrun/data/code/`
  - or, in the terminal **terminal**
    1. If you don't have a terminal, open one by searching for `Terminal: focus on terminal view` in the command pallette.
    1. Navigate to `~/data/code`
    1. Clone using `git clone https://github.com/PumasAI-Labs/ViralDynamicsWorkshop.git` 


## Schedule and Materials

| Time | Session | Materials |
|------|---------|-----------|
| 09:00 - 09:20 | **Welcome and Introduction** | [Slides](01-introduction.html) |
| 09:20 - 10:30 | **NLME modeling in Pumas** | *Hands-on* |
| 10:30 - 10:45 | ‚òï **Coffee Break** | |
| 10:45 - 11:15 | **DeepNLME** | [Slides](02-deepnlme-part1.html) |
| | *Neural networks, SciML, UDEs and NeuralODEs* | |
| 11:15 - 12:30 | **DeepNLME (hands-on)** | *Hands-on* |
| 12:30 - 13:30 | üçΩÔ∏è **Lunch Break** | |
| 13:30 - 13:55 | **Random effects, fitting NLME, and Generative AI** | [Slides](03-random-effects-revisited.html) |
| 13:55 - 14:40 | **DeepNLME with Complex Covariates** | [Slides](05-covariate-modelling.html) and hands-on|
| 14:40 - 15:00 | **NLME and Generative AI** | [Slides](04-generative-ai.html) |
| 15:00 - 15:30 | **Embeddings** | [Slides](06-embeddings.html) or hands-on |
| 15:30 - 15:45 | ‚òï **Coffee Break** | |
| 15:45 - 16:15 | **Epidemiology Demo** | [Slides](07-epidemiology-demo.html) |
| 16:15 - 17:00 | **Discussions and Conclusions** |  |

## Key Concepts Covered

### Welcome and Introduction
- Machine learning vs. scientific modeling: strengths and limitations
- The vision for combining mechanism and machine learning across pharma
- Building enhanced NLME models with neural components

### NLME Modeling in Pumas
- Traditional nonlinear mixed effects modeling
- PK, PK/PD, and sequential data modeling
- Population parameter estimation and random effects
- Hands-on implementation with HIV viral dynamics data

### DeepNLME Fundamentals
- Neural networks as universal function approximators
- Scientific Machine Learning (SciML) and Universal Differential Equations (UDEs)
- Neural ODEs and structured neural enhancements
- DeepNLME: extending UDEs for longitudinal pharmacometric data

### Random Effects and Model Fitting
- Understanding random effects in mixed models
- Empirical Bayes Estimates (EBEs) and individual parameter estimation
- Maximum likelihood estimation and the EM algorithm
- Computational considerations for fitting DeepNLME models

### Complex Covariates and Embeddings
- Working with high-dimensional and complex covariates
- Patient embeddings from EBEs and clinical data
- Text embeddings using pre-trained language models
- Dimensionality reduction and subspace analysis
- Neural networks for covariate-to-parameter relationships

### NLME and Generative AI
- Mathematical connections between NLME and modern generative AI
- Latent variable models, VAEs, and diffusion models
- Clinical interpretation of learned embeddings
- Future directions and regulatory considerations

### Embeddings Deep Dive
- Advanced embedding techniques for pharmacometric applications
- Integration of multi-modal data (text, images, sequences)
- Transfer learning from pre-trained models
- Practical considerations for implementation

### Epidemiology Applications
- Age-stratified seroprevalence modeling
- Data-driven discovery of force of infection patterns
- Information sharing across populations and studies
- Handling heterogeneous data quality and sparse sampling

## Learning Objectives

By the end of this workshop, participants will be able to:

1. **Understand** the theoretical foundations connecting mechanistic modeling and machine learning
2. **Implement** DeepNLME models for viral dynamics and other applications  
3. **Work with** complex covariates including text data and embeddings
4. **Apply** information sharing techniques across populations
5. **Recognize** connections between NLME and modern generative AI
6. **Evaluate** when and how to use DeepNLME approaches in practice

## Prerequisites

- Familiarity with NLME modeling concepts

## Resources

- [DeepPumas Documentation](https://docs.pumas.ai/dev/DeepPumas/overview/)
- [Pumas Documentation](https://docs.pumas.ai/)
- [Workshop GitHub Repository](https://github.com/PumasAI-Labs/ViralDynamicsWorkshop)

---